// Copyright (c) 2024 The Stdlib Authors. License is Apache-2.0: http://www.apache.org/licenses/LICENSE-2.0
/// <reference types="./index.d.ts" />
import t from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-define-nonenumerable-read-only-property@v0.1.0-esm/index.mjs";import e from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-array-like@v0.2.0-esm/index.mjs";import r from"https://cdn.jsdelivr.net/gh/stdlib-js/proxy-ctor@v0.2.0-esm/index.mjs";import s from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-arraylike2object@v0.2.0-esm/index.mjs";import n from"https://cdn.jsdelivr.net/gh/stdlib-js/object-assign@v0.2.0-esm/index.mjs";import i from"https://cdn.jsdelivr.net/gh/stdlib-js/string-format@v0.1.1-esm/index.mjs";import a from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-assert-is-complex-floating-point-data-type@v0.2.0-esm/index.mjs";import{isPrimitive as o}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-number@v0.2.0-esm/index.mjs";import d from"https://cdn.jsdelivr.net/gh/stdlib-js/array-index@v0.2.0-esm/index.mjs";import l from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-plain-object@v0.2.0-esm/index.mjs";import c from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-has-own-property@v0.2.0-esm/index.mjs";import{isPrimitive as p}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-boolean@v0.2.0-esm/index.mjs";import m from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-method-in@v0.2.0-esm/index.mjs";import{isPrimitive as u}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-integer@v0.2.0-esm/index.mjs";import v from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-complex-like@v0.2.0-esm/index.mjs";import f from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-assert-is-real-floating-point-data-type@v0.2.0-esm/index.mjs";import h from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-assert-is-unsigned-integer-data-type@v0.2.0-esm/index.mjs";import y from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-assert-is-signed-integer-data-type@v0.2.0-esm/index.mjs";import j from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-assert-is-safe-data-type-cast@v0.3.0-esm/index.mjs";import g from"https://cdn.jsdelivr.net/gh/stdlib-js/array-min-dtype@v0.2.0-esm/index.mjs";import b from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-min-signed-integer-dtype@v0.2.0-esm/index.mjs";import w from"https://cdn.jsdelivr.net/gh/stdlib-js/complex-dtype@v0.2.0-esm/index.mjs";import{isPrimitive as x}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-string@v0.2.0-esm/index.mjs";import E from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-has-property@v0.2.0-esm/index.mjs";import A from"https://cdn.jsdelivr.net/gh/stdlib-js/array-take@v0.1.0-esm/index.mjs";import k from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-mskfilter@v0.2.0-esm/index.mjs";import T from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-mskreject@v0.2.0-esm/index.mjs";import D from"https://cdn.jsdelivr.net/gh/stdlib-js/string-base-trim@v0.2.0-esm/index.mjs";import S from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-normalize-index@v0.2.0-esm/index.mjs";import I from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-function@v0.2.0-esm/index.mjs";import R from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-fancy-slice@v0.3.0-esm/index.mjs";import _ from"https://cdn.jsdelivr.net/gh/stdlib-js/string-base-replace@v0.2.0-esm/index.mjs";import V from"https://cdn.jsdelivr.net/gh/stdlib-js/slice-base-seq2slice@v0.2.0-esm/index.mjs";import N from"https://cdn.jsdelivr.net/gh/stdlib-js/slice-base-str2slice@v0.2.0-esm/index.mjs";import U from"https://cdn.jsdelivr.net/gh/stdlib-js/string-base-starts-with@v0.2.0-esm/index.mjs";import G from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-collection@v0.2.0-esm/index.mjs";import O from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-fancy-slice-assign@v0.2.0-esm/index.mjs";import C from"https://cdn.jsdelivr.net/gh/stdlib-js/array-from-scalar@v0.2.0-esm/index.mjs";function L(t){return o(t)?[t,0]:t}function P(t){return a(t)?L:null}function z(t,e){return function(r){return t(r,e)}}var F="function"==typeof r;function q(){return{cache:d,strict:!1}}function B(t,e){return l(e)?c(e,"strict")&&(t.strict=e.strict,!p(t.strict))?new TypeError(i("invalid option. `%s` option must be a boolean. Option: `%s`.","strict",t.strict)):c(e,"cache")&&(t.cache=e.cache,!m(t.cache,"get"))?new TypeError(i("invalid option. `%s` option is missing a `%s` method. Option: `%s`.","cache","get",t.cache)):null:new TypeError(i("invalid argument. Options argument must be an object. Value: `%s`.",e))}function M(){return null}function Q(t,e){return o(t)?null:v(t)?new TypeError(i("invalid operation. Assigned value cannot be safely cast to the target array data type. Data types: [%s, %s].",w(t),e)):new TypeError(i("invalid operation. Assigned value cannot be safely cast to the target array data type. Data types: [%s, %s].",typeof t,e))}function W(t,e){return o(t)||v(t)?null:new TypeError(i("invalid operation. Assigned value cannot be safely cast to the target array data type. Data types: [%s, %s].",typeof t,e))}function $(t,e){var r;return o(t)?u(t)?(r=b(t),j(r,e)?null:new TypeError(i("invalid operation. Assigned value cannot be safely cast to the target array data type. Data types: [%s, %s].",r,e))):new TypeError(i("invalid operation. Assigned value cannot be safely cast to the target array data type. Data types: [%s, %s].",g(t),e)):v(t)?new TypeError(i("invalid operation. Assigned value cannot be safely cast to the target array data type. Data types: [%s, %s].",w(t),e)):new TypeError(i("invalid operation. Assigned value cannot be safely cast to the target array data type. Data types: [%s, %s].",typeof t,e))}function H(t,e){var r;return o(t)?(r=g(t),j(r,e)?null:new TypeError(i("invalid operation. Assigned value cannot be safely cast to the target array data type. Data types: [%s, %s].",r,e))):v(t)?new TypeError(i("invalid operation. Assigned value cannot be safely cast to the target array data type. Data types: [%s, %s].",w(t),e)):new TypeError(i("invalid operation. Assigned value cannot be safely cast to the target array data type. Data types: [%s, %s].",typeof t,e))}function J(t){return"generic"===t||""===t?M:f(t)?Q:h(t)?H:y(t)?$:W}function K(t,e){return function(r,s){var n,i;switch((i=s).length){case 0:n=new r;break;case 1:n=new r(i[0]);break;case 2:n=new r(i[0],i[1]);break;case 3:n=new r(i[0],i[1],i[2]);break;case 4:n=new r(i[0],i[1],i[2],i[3]);break;case 5:n=new r(i[0],i[1],i[2],i[3],i[4]);break;case 6:n=new r(i[0],i[1],i[2],i[3],i[4],i[5]);break;case 7:n=new r(i[0],i[1],i[2],i[3],i[4],i[5],i[6]);break;case 8:n=new r(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]);break;case 9:n=new r(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8]);break;case 10:n=new r(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8],i[9]);break;default:n=r.apply(null,i)}return t(n,e)}}var X=/^-?[0-9]+$/;function Y(t){return x(t)&&X.test(t)}var Z=/\s*ArrayIndex<[^>]+>\s*/;function tt(t,e,r){var s=function(t,e){var r,s=e.get((r=D(t)).substring(11,r.length-1));if(null===s)throw new Error(i("invalid operation. Unable to resolve array index. Value: `%s`.",t));return s}(e,r.cache);if("int"===s.type)return r.postGetArray(A(t,s.data));if("bool"===s.type)return r.postGetArray(k(t,s.data));if("mask"===s.type)return r.postGetArray(T(t,s.data));throw new Error(i("invalid operation. Unrecognized array index type. Value: `%s`.",s.type))}function et(t,e,r){var s,n;if(s=parseInt(t,10),-1===(n=S(s,e-1))){if(r)throw new RangeError(i("invalid operation. Index exceeds array bounds."));return s}return n}function rt(t){return _(t,/^invalid argument/,"invalid operation")}var st=/:/;function nt(t,e,r){var s=D(e);return function(t){return"S"===t[0]&&U(t,"Slice(",0)&&")"===t[t.length-1]}(s)?function(t,e){var r=N(e);if(null===r)throw new Error(i("invalid operation. Unsupported slice operation. Value: `%s`.",t));return r}(e,s):function(t){return st.test(t)}(s)?function(t,e,r,s){var n=V(e,r,!0);if(n.code){if("ERR_SLICE_INVALID_INCREMENT"===n.code)throw new Error(i("invalid operation. A subsequence increment must be a non-zero integer. Value: `%s`.",t));if("ERR_SLICE_INVALID_SUBSEQUENCE"===n.code)throw new Error(i("invalid operation. Unsupported slice operation. Value: `%s`.",t));if("ERR_SLICE_OUT_OF_BOUNDS"===n.code){if(s)throw new RangeError(i("invalid operation. Slice exceeds array bounds."));n=V(e,r,!1)}}return n}(e,s,t.length,r):null}function it(t){return function(e,r,s){if(Y(r))return function(t,e,r){return r.getter(t,et(e,t.length,r.strict))}(e,r,t);if(E(e,r)||!x(r))return function(t,e,r,s){var n=t[e];return I(n)?n===t.constructor?s.ctor:function(){var e,s;for(e=[],s=0;s<arguments.length;s++)e.push(arguments[s]);return n.apply(this===r?t:this,e)}:n}(e,r,s,t);if(n=r,x(n)&&Z.test(n))return tt(e,r,t);var n;return function(t,e,r){var s=nt(t,e,r.strict);if(null!==s)try{return r.postGetArray(R(t,s,r.strict))}catch(t){throw new t.constructor(rt(t.message))}}(e,r,t)}}function at(t,e,r){return t[e]=r,!0}function ot(t){return function(e,r,s,n){var i;if(Y(r))return function(t,e,r,s){var n,i;if(n=s.validator(r,s.dtype))throw n;return i=s.preSetElement?s.preSetElement(r):r,s.setter(t,et(e,t.length,s.strict),i),!0}(e,r,s,t);if(E(r)||!x(r))return at(e,r,s);if(i=function(t,e,r,s,n){var i,a,o;if(null===(a=nt(t,e,n.strict)))return!1;if(G(r))o=r;else{if(i=n.validator(r,n.dtype))throw i;o=C(r,n.dtype)}try{return O(o,s,a,n.strict),!0}catch(i){throw new i.constructor(rt(i.message))}}(e,r,s,n,t),i)return i;return at(e,r,s)}}function dt(){var t,a;if(t=q(),arguments.length&&(a=B(t,arguments[0])))throw a;return o;function o(a){var d,l,c,p,m;if(!e(a))throw new TypeError(i("invalid argument. First argument must be array-like. Value: `%s`.",a));if(F){if(d=n({},t),arguments.length>1&&(l=B(d,arguments[1])))throw l;return m={ref:a,dtype:p=(c=s(a)).dtype||"",getter:c.accessors[0],setter:c.accessors[1],preSetElement:P(p),postGetArray:z(o,d),cache:d.cache,strict:d.strict,validator:J(p),array2fancy:o,ctor:new r(a.constructor||Array,{construct:K(o,d)})},new r(a,{get:it(m),set:ot(m)})}return console.warn("WARNING: Proxy objects are not supported in the current environment. Some `FancyArray` functionality may not be available."),a}}var lt=dt();t(lt,"factory",dt);export{lt as default,dt as factory};
//# sourceMappingURL=index.mjs.map
